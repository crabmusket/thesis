\chapter{Model}

\section{Model structure}

In this thesis, I develop several models, all based on a common structure.
The models are formulated as linear time-varying systems where at time $t$, the rate of change of the state $\dot{\vec{x}}_t$ depends on the current state $\vec{x}_t$, the input $\vec{u}_t$, and the disturbance $\vec{d}_t$, combined using matrices $A$, $B_u$ and $B_d$ which may all depend on $t$:
\begin{equation}
	\dot{\vec{x}}_t = A_t \vec{x}_t \times B_{u, t} \vec{u}_t \times B_{d, t} \vec{d}_t.
	\label{eq:xdot}
\end{equation}
This standard state-space model is discretised to a form appropriate for computer simulations assuming a zero-order hold on the input signal $\vec{u}$ between $\vec{u}_k$ and $\vec{u}_{k+1}$, resulting in new matrices $A_d, B_{du}$ and $B_{dd}$.
To discretise the two different $B$ matrices, we treat them as a single matrix $B$ with form
\begin{displaymath}
	B = \left[\begin{array}{cc}
		B_u & B_d
	\end{array}\right]
\end{displaymath}
and then use the usual method of discretising state-space systems with a period of $\delta t$,
\begin{eqnarray}
	A_{d, t} &=& e^{A_t \delta t}, \\
	B_{d, t} &=& A_t^{-1} (A_{d, t} - I) B_t.
\end{eqnarray}
We can then reconstruct the new $B_{ud, t}$ and $B_{dd, t}$ matrices from the appropriate columns of $B_d$.

\section{Halvgaard mixed-tank model}
\label{sec:model:halvgaard}


